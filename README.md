**Demo Exam 2025: –ü–æ—à–∞–≥–æ–≤–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è**

_–û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –∫–æ–º–ø–ª–µ–∫—Å–µ –æ—Ü–µ–Ω–æ—á–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —ç–∫–∑–∞–º–µ–Ω–∞ (–ö–û–î 09.02.06-1-2025)

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø](#–ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π-—ç—Ç–∞–ø)
2. [–ú–æ–¥—É–ª—å 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#–º–æ–¥—É–ª—å-1-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–µ—Ç–µ–≤–æ–π-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)
3. [–ú–æ–¥—É–ª—å 2: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è](#–º–æ–¥—É–ª—å-2-–æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è-—Å–µ—Ç–µ–≤–æ–≥–æ-–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è)
4. [–ú–æ–¥—É–ª—å 3: –≠–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã](#–º–æ–¥—É–ª—å-3-—ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—è-–æ–±—ä–µ–∫—Ç–æ–≤-—Å–µ—Ç–µ–≤–æ–π-–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã)

---

## –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–π —ç—Ç–∞–ø

1. **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏ –º–∞—à–∏–Ω—ã**
   - Debian 12 "Bookworm" –∏–ª–∏ –∞–Ω–∞–ª–æ–≥ –Ω–∞ –∫–∞–∂–¥–æ–π VM.
   - –£–±–µ–¥–∏—Ç–µ—Å—å –≤ –Ω–∞–ª–∏—á–∏–∏ —Ç—Ä–µ–±—É–µ–º—ã—Ö —Å–µ—Ç–µ–≤—ã—Ö –∞–¥–∞–ø—Ç–µ—Ä–æ–≤:

     | –ú–∞—à–∏–Ω–∞    | –ê–¥–∞–ø—Ç–µ—Ä—ã                                   |
     |-----------|--------------------------------------------|
     | ISP       | ens18 (k HQ), ens19 (k BR), ens20 (WAN)    |
     | HQ-RTR    | ens18 (WAN), ens19 (LAN)                   |
     | BR-RTR    | ens18 (WAN), ens19 (LAN)                   |
     | HQ-SRV    | ens18 (+ 3 –¥–∏—Å–∫–∞ 1 –ì–ë –¥–ª—è RAID)            |
     | BR-SRV    | ens18                                     |
     | HQ-CLI    | ens18                                     |

2. **IP-–∞–¥—Ä–µ—Å–∞—Ü–∏—è** (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º VLAN 100/200/999 –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é)

   | –£—Å—Ç—Ä-–≤–æ   | –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å     | IP/Mask          | –®–ª—é–∑          | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π               |
   |-----------|---------------|------------------|---------------|--------------------------|
   | ISP ens18 | ens18         | 172.16.4.1/28    | -             | —Å–≤—è–∑—å —Å HQ               |
   | ISP ens19 | ens19         | 172.16.5.1/28    | -             | —Å–≤—è–∑—å —Å BR               |
   | ISP ens20 | ens20         | DHCP             | -             | –≤—ã—Ö–æ–¥ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç         |
   | HQ-RTR    | ens18         | 172.16.4.2/28    | 172.16.4.1    |                          |
   | HQ-RTR    | ens19         | 192.168.100.1/24 | -             | LAN HQ                   |
   | BR-RTR    | ens18         | 172.16.5.2/28    | 172.16.5.1    |                          |
   | BR-RTR    | ens19         | 192.168.200.1/24 | -             | LAN BR                   |
   | HQ-SRV    | ens18         | 192.168.100.10/24| 192.168.100.1 |                          |
   | BR-SRV    | ens18         | 192.168.200.10/24| 192.168.200.1 |                          |
   | HQ-CLI    | ens18         | DHCP via HQ-RTR  | 192.168.100.1 |                          |
   | Tunnel    | tun0 (HQ)     | 10.10.10.1/30    | -             |                          |
   | Tunnel    | tun0 (BR)     | 10.10.10.2/30    | -             |                          |

3. **–î–æ–º–µ–Ω –¥–ª—è –≤—Å–µ—Ö –º–∞—à–∏–Ω**: `au-team.irpo`

---

# üì¶ –¢—Ä–µ–±—É–µ–º—ã–µ –ø–∞–∫–µ—Ç—ã –¥–ª—è –î–µ–º–æ—ç–∫–∑–∞–º–µ–Ω–∞ 2025

–ü–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏–π —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–∞—à–∏–Ω—ã –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç –∏ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–∞–∫–µ—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.

---

## ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ –≤—Å–µ –º–∞—à–∏–Ω—ã (–æ–±—â–∏–µ –ø–∞–∫–µ—Ç—ã)

```bash
apt update && apt install -y \
  network-manager \
  net-tools \
  iproute2 \
  openssh-client \
  openssh-server \
  traceroute \
  curl \
  sudo
```

---

## üìå –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–∞—à–∏–Ω—ã

| –ú–∞—à–∏–Ω–∞     | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                                | –ü–∞–∫–µ—Ç—ã –∫ —É—Å—Ç–∞–Ω–æ–≤–∫–µ                                                                 |
|------------|-------------------------------------------|-------------------------------------------------------------------------------------|
| **ISP**    | –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—à–ª—é–∑ –∏ –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä             | `nftables`, `network-manager`                                                      |
| **HQ-RTR** | –û—Å–Ω–æ–≤–Ω–æ–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä, DHCP, GRE, OSPF   | `nftables`, `network-manager`, `isc-dhcp-server`, `frr`, `frr-pythontools`         |
| **BR-RTR** | –†–µ–∑–µ—Ä–≤–Ω—ã–π –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä, GRE, OSPF        | `nftables`, `network-manager`, `frr`, `frr-pythontools`                            |
| **HQ-SRV** | –°–µ—Ä–≤–µ—Ä HQ: DNS, NFS, RAID, Chrony         | `bind9`, `bind9-utils`, `nfs-kernel-server`, `mdadm`, `chrony`                     |
| **BR-SRV** | –°–µ—Ä–≤–µ—Ä BR: Samba AD DC, Ansible, Docker   | `samba`, `krb5-config`, `winbind`, `smbclient`, `ansible`, `docker.io`, `docker-compose` |
| **HQ-CLI** | –ö–ª–∏–µ–Ω—Ç: –≤—Ö–æ–¥ –≤ –¥–æ–º–µ–Ω                      | `realmd`, `sssd`, `sssd-tools`, `adcli`, `packagekit`, `samba-common-bin`          |

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ

- `nmtui` ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ç–∏ (`network-manager` –∏–ª–∏ `network-manager-gnome`)
- –î–ª—è GRE: `iproute2` (–ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Debian)
- –î–ª—è RAID: —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –¥–∏—Å–∫–∏ `/dev/sdb`, `/dev/sdc`, `/dev/sdd` –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç

## –ú–æ–¥—É–ª—å 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ç–µ–≤–æ–π –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 1 —á. 00 –º–∏–Ω 

### 1. –ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –∏–º—ë–Ω —Ö–æ—Å—Ç–∞–º
```bash
hostnamectl set-hostname hq-rtr.au-team.irpo
```

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ —Å nmcli
<details>
<summary>–ü—Ä–∏–º–µ—Ä –¥–ª—è HQ-RTR</summary>
```bash
nmcli con add type ethernet con-name WAN ifname ens18 ip4 172.16.4.2/28 gw4 172.16.4.1
nmcli con mod WAN ipv4.dns 8.8.8.8
nmcli con up WAN

nmcli con add type ethernet con-name LAN ifname ens19 ip4 192.168.100.1/24
nmcli con up LAN
```
</details>

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è ISP
```bash
nmcli con add type ethernet con-name TO-HQ ifname ens18 ip4 172.16.4.1/28
nmcli con up TO-HQ

nmcli con add type ethernet con-name TO-BR ifname ens19 ip4 172.16.5.1/28
nmcli con up TO-BR

nmcli con add type ethernet con-name WAN-DHCP ifname ens20
nmcli con up WAN-DHCP
```

### 4. –í–∫–ª—é—á–µ–Ω–∏–µ IP-—Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥–∞ –∏ NAT (nftables)
```bash
echo "net.ipv4.ip_forward=1" > /etc/sysctl.d/99-forwarding.conf
sysctl -p /etc/sysctl.d/99-forwarding.conf

apt update && apt install -y nftables
# –í /etc/nftables.conf –¥–æ–±–∞–≤–∏—Ç—å:
# chain postrouting { type nat hook postrouting priority 100; policy accept; oifname ens20 masquerade }
systemctl enable --now nftables
```

### 5. GRE-—Ç—É–Ω–Ω–µ–ª—å
 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GRE-—Ç—É–Ω–Ω–µ–ª—è —á–µ—Ä–µ–∑ nmtui

–í —ç—Ç–æ–º —Ñ–∞–π–ª–µ –ø—Ä–∏–≤–µ–¥–µ–Ω—ã —Ç–æ—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ–ª–µ–π –¥–ª—è –¥–≤—É—Ö –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ç–æ—Ä–æ–≤: HQ-RTR –∏ BR-RTR, –ø–æ —Ç–µ–∫—É—â–µ–π —Å—Ö–µ–º–µ.

---

## 1. HQ-RTR (172.16.4.2 ‚Üî 172.16.5.2)

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ `nmtui` ‚Üí **Edit a connection** ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à IP-tunnel (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gre-tun0`) ‚Üí **Edit**:

   ```text
   Profile name:  gre-tun0
   Device:        tun0

   ‚îÄ‚îÄ IP tunnel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   Mode:          GRE
   Parent:        ens18
   Local IP:      172.16.4.2
   Remote IP:     172.16.5.2
   MTU:           1400

   ‚îÄ‚îÄ IPv4 CONFIGURATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   Method:        Manual
   Addresses:     10.10.10.1/30     # —Ç—É–Ω–Ω–µ–ª—å–Ω—ã–π –∞–¥—Ä–µ—Å
   Gateway:       (leave empty)    # —à–ª—é–∑ –Ω–µ –Ω—É–∂–µ–Ω
   DNS servers:   (leave empty)
   ```

2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ **Activate** ‚Üí `gre-tun0`.

---

## 2. BR-RTR (172.16.5.2 ‚Üî 172.16.4.2)

1. –í `nmtui` ‚Üí **Edit a connection** ‚Üí –≤–∞—à —Ç—É–Ω–Ω–µ–ª—å ‚Üí **Edit**:

   ```text
   Profile name:  gre-tun0
   Device:        tun0

   ‚îÄ‚îÄ IP tunnel ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   Mode:          GRE
   Parent:        ens18
   Local IP:      172.16.5.2
   Remote IP:     172.16.4.2
   MTU:           1400

   ‚îÄ‚îÄ IPv4 CONFIGURATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
   Method:        Manual
   Addresses:     10.10.10.2/30
   Gateway:       (leave empty)
   DNS servers:   (leave empty)
   ```

2. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ **Activate** ‚Üí `gre-tun0`.

---

–ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `tun0` –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–Ω–∏–º–∞—Ç—å—Å—è —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è—Ç—Å—è –ø—Ä–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ NetworkManager.


### 6. OSPF (FRR)
```bash
apt install -y frr frr-pythontools
# /etc/frr/daemons: zebra=yes ospfd=yes
systemctl enable --now frr
vtysh <<EOF
conf t
router ospf
 ospf router-id 1.1.1.1       # HQ (BR: 2.2.2.2)
 network 10.10.10.0/30 area 0
 network 192.168.100.0/24 area 0
 passive-interface ens19
 area 0 authentication message-digest
 interface tun0
  ip ospf message-digest-key 1 md5 MySecretPass
exit
write
EOF
```

### 7. DHCP-—Å–µ—Ä–≤–µ—Ä (ISC DHCP)
```bash
apt install -y isc-dhcp-server
authoritative;

option domain-name "au-team.irpo";
option domain-name-servers 192.168.1.2, 8.8.8.8;

subnet 192.168.2.0 netmask 255.255.255.240 {
    range 192.168.2.2 192.168.2.14;
    option routers 192.168.2.1;
    option broadcast-address 192.168.2.15;
    option domain-search "au-team.irpo";
}

systemctl enable --now isc-dhcp-server
reboot
```

### 8. DNS-—Å–µ—Ä–≤–µ—Ä (BIND9)
```bash
apt install -y bind9 bind9-utils
# /etc/bind/named.conf.options: forwarders { 8.8.8.8; 8.8.4.4; }
# /etc/bind/named.conf.local: –∑–æ–Ω—ã au-team.irpo –∏ 100.168.192.in-addr.arpa
named-checkconf && named-checkzone au-team.irpo /etc/bind/db.au-team.irpo
systemctl enable --now bind9
```

---

## –ú–æ–¥—É–ª—å 2: –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è

**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**: 1 —á. 30 –º–∏–Ω 

### 1. Samba AD DC (BR-SRV)
```bash
apt install -y samba krb5-config winbind smbclient
samba-tool domain provision --use-rfc2307 --interactive
cp /var/lib/samba/private/krb5.conf /etc/
systemctl unmask samba-ad-dc && systemctl enable --now samba-ad-dc
```

### 2. –í—Ö–æ–¥ –∫–ª–∏–µ–Ω—Ç–∞ –≤ –¥–æ–º–µ–Ω (HQ-CLI)
```bash
apt install -y realmd sssd sssd-tools adcli packagekit samba-common-bin
realm join --user=administrator au-team.irpo
```

### 3. RAID¬†5 + NFS (HQ-SRV)
```bash
apt install -y mdadm nfs-kernel-server
mdadm --create /dev/md0 --level=5 --raid-devices=3 /dev/sdb /dev/sdc /dev/sdd
mkfs.ext4 /dev/md0 && echo "/dev/md0 /raid5 ext4 defaults 0 0" >> /etc/fstab
mkdir -p /raid5/nfs && chown nobody:nogroup /raid5/nfs
echo "/raid5/nfs 192.168.100.0/24(rw,sync,no_subtree_check)" >> /etc/exports
exportfs -a && systemctl restart nfs-kernel-server
```

### 4. Chrony NTP
```bash
apt install -y chrony
# /etc/chrony/chrony.conf: local stratum 5, allow 192.168.0.0/16
systemctl restart chrony
# –ö–ª–∏–µ–Ω—Ç—ã: server hq-rtr.au-team.irpo iburst
```

### 5. Ansible (BR-SRV)
```bash
apt install -y ansible
cat <<EOF > /etc/ansible/hosts
[routers]
hq-rtr.au-team.irpo
br-rtr.au-team.irpo

[servers]
hq-srv.au-team.irpo
br-srv.au-team.irpo

[clients]
hq-cli.au-team.irpo

[all:vars]
ansible_user=net_admin
ansible_ssh_pass=P@$$word
ansible_become_pass=P@$$word
EOF

ansible all -m ping
```

### 6. Docker + MediaWiki (BR-SRV)
```bash
apt install -y docker.io docker-compose
docker run -d -p 8080:80 --name mediawiki mediawiki
```
